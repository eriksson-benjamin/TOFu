
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Welcome to TOFu analysis code documentation! &#8212; docs  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-tofu-analysis-code-documentation">
<h1>Welcome to TOFu analysis code documentation!<a class="headerlink" href="#welcome-to-tofu-analysis-code-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<span class="target" id="module-tofu_functions"></span><p>Created on Thu Jul 11 08:27:51 2019</p>
<p>&#64;author: beriksso</p>
<dl class="function">
<dt id="tofu_functions.background_subtraction">
<code class="descclassname">tofu_functions.</code><code class="descname">background_subtraction</code><span class="sig-paren">(</span><em>coincidences</em>, <em>tof_bins</em>, <em>energies_S1</em>, <em>S1_info</em>, <em>energies_S2</em>, <em>S2_info</em>, <em>disable_cuts</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.background_subtraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs background subtraction of TOF spectrum using negative flight 
times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>coincidences</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of times-of-flight (ns).</p>
</dd>
<dt><strong>tof_bins</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">Bins used for TOF spectrum.</p>
</dd>
<dt><strong>energies_S1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of energies (MeVee) for S1.</p>
</dd>
<dt><strong>S1_info</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict,</span></dt>
<dd><p class="first last">Contains S1 information on energy bins, limits, etc.</p>
</dd>
<dt><strong>energies_S2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of energies (MeVee) for S2.</p>
</dd>
<dt><strong>S2_info</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict,</span></dt>
<dd><p class="first last">Contains S2 information on energy bins, limits, etc.</p>
</dd>
<dt><strong>disable_cuts</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean,</span></dt>
<dd><p class="first last">If set to True, calculates the background as the average value
between TOF -100 to -50 ns. If set to False, takes kinematic
cuts into consideration.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tof_bg</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array, background TOF component. Component is flipped to positive
flight times. The entire component is returned (i.e. negative and 
positive part) for the given input bins.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.baseline_reduction">
<code class="descclassname">tofu_functions.</code><code class="descname">baseline_reduction</code><span class="sig-paren">(</span><em>pulse_data</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.baseline_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts the baseline average of the first 10 samples from each pulse. 
Returns the same pulse data array with the base line centred around zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pulse_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">2D array of pulse waveforms where each row corresponds to one 
pulse. Typically 64 samples in each row for ADQ14 (board 1-5) 
and 56 samples for ADQ412 (board 6-10).</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pulses_baseline</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Same as pulse_data but with baseline centred around 0.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">baseline_reduction</span><span class="p">(</span>
<span class="go">                array([[26969, 26974, 26992, ..., 26793, 26734, 26671],</span>
<span class="go">                       ...,</span>
<span class="go">                       [26969, 26951, 26974, ..., 26684, 26675, 26630]])</span>
<span class="go">                      )</span>
<span class="go">array([[  -9.6,   -4.6,   13.4, ..., -185.6, -244.6, -307.6],</span>
<span class="go">       ...,</span>
<span class="go">       [   1.8,  -16.2,    6.8, ..., -283.2, -292.2, -337.2]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.cleanup">
<code class="descclassname">tofu_functions.</code><code class="descname">cleanup</code><span class="sig-paren">(</span><em>pulses, dx, detector_name, bias_level, baseline_cut=array([[0, 0],        [0, 0]]), timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.cleanup" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an array of baseline reduced pulses and removes junk pulses.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pulses</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">2D array of pulse waveforms where each row corresponds to one 
waveform. Must be baseline reduced [see baseline_reduction()].</p>
</dd>
<dt><strong>dx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float,</span></dt>
<dd><p class="first last">Distance between each point on the x-axis. Typically 1 ns.</p>
</dd>
<dt><strong>bias_level</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int,</span></dt>
<dd><p class="first last">Digitizer bias level used for the shot.</p>
</dd>
<dt><strong>baseline_cut</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">Baselines which fluctuate more than the thresholds given in 
baseline_cut (in codes) are removed.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>new_pulses</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">2D array of pulse waveforms without junk waveforms.</p>
</dd>
<dt><strong>bad_indices</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">Index numbers of the removed waveforms.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cleanup</span><span class="p">(</span><span class="n">pulses</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;S1_01&#39;</span><span class="p">,</span> <span class="mi">27000</span><span class="p">)</span>
<span class="go">[[ 2.00e-01 -2.80e+00  2.00e-01 ... -1.98e+01 -1.88e+01 -1.68e+01]</span>
<span class="go"> [ 1.00e+00  2.00e+00  1.00e+00 ... -1.70e+01 -1.40e+01 -1.20e+01]</span>
<span class="go"> [-1.00e+00  2.00e+00 -2.00e+00 ... -1.75e+02 -1.57e+02 -1.38e+02]</span>
<span class="go"> ...</span>
<span class="go"> [ 3.00e-01 -7.00e-01  3.30e+00 ... -1.70e+00  3.00e-01 -7.00e-01]</span>
<span class="go"> [ 3.90e+00 -1.00e-01 -1.10e+00 ... -7.10e+00 -5.10e+00 -8.10e+00]</span>
<span class="go"> [ 8.00e-01  1.80e+00 -1.20e+00 ... -1.02e+01 -1.22e+01 -9.20e+00]]</span>
<span class="go">[11, 22, 25,..., 1572, 1574]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.elapsed_time">
<code class="descclassname">tofu_functions.</code><code class="descname">elapsed_time</code><span class="sig-paren">(</span><em>time_start=0.0</em>, <em>timed_function=''</em>, <em>return_time=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.elapsed_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional timer for functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time_start</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Starting time, used to calculate the elapsed time</p>
</dd>
<dt><strong>timed_function</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">String used in print statement, typically set to the 
function being timed.</p>
</dd>
<dt><strong>return_time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">Returns the elapsed time</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>return_time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float,</span></dt>
<dd><p class="first last">Elapsed time (s)</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_start</span> <span class="o">=</span> <span class="n">elapsed_time</span><span class="p">()</span> <span class="c1"># Start timer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elapsed_time</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="s1">&#39;example function&#39;</span><span class="p">)</span> <span class="c1"># Print elapsed time</span>
<span class="go">Elapsed time for example function: 1.00 sec.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.find_ohmic_phase">
<code class="descclassname">tofu_functions.</code><code class="descname">find_ohmic_phase</code><span class="sig-paren">(</span><em>shot_number</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.find_ohmic_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the JET time (s) at which the Ohmic phase is over for given shot number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>t_end</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float,</span></dt>
<dd><p class="first last">JET time at which the Ohmic phase stops, i.e. the time at which any
heating but Ohmic heatings is applied.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_ohmic_phase</span><span class="p">(</span><span class="mi">98044</span><span class="p">)</span>
<span class="go">47.008</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.find_points">
<code class="descclassname">tofu_functions.</code><code class="descname">find_points</code><span class="sig-paren">(</span><em>pulse_data</em>, <em>value</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.find_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indicies of the points closest to “value” in pulse_data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pulse_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">2D array of pulse height data where each row corresponds to one 
record. NOTE: pulse_data must be baseline reduced (see 
baseline_reduction() function).</p>
</dd>
<dt><strong>value</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of values</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>index</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of indices from pulse_data corresponding to the position
in each row with value closest to “value”.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pulse_data</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_points</span><span class="p">(</span><span class="n">pulse_data</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">array([16, 16,  15, 16, ..., 16, 15, 17, 15, 16, 16])  </span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.find_threshold">
<code class="descclassname">tofu_functions.</code><code class="descname">find_threshold</code><span class="sig-paren">(</span><em>pulse_data</em>, <em>trig_level</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.find_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the point in the pulse which crosses the trigger level 
(generally sample 16, 17, 18 or 19 ns for ADQ14). Mainly relevant for ADQ14
cards since the number of pre trigger samples varies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pulse_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">2D array of pulse waveforms where each row corresponds to one 
pulse. Typically 64 samples in each row for ADQ14 (board 1-5) 
and 56 samples for ADQ412 (board 6-10).</p>
</dd>
<dt><strong>trig_level</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Trigger level used during acquisition in codes.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>thr_crossing</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of indices at which each pulse crosses the given
threshold.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_threshold</span><span class="p">(</span><span class="n">pulse_data</span><span class="p">,</span> <span class="mi">26000</span><span class="p">)</span>
<span class="go">array([16, 16, 16, ..., 16, 18, 16])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.find_time_range">
<code class="descclassname">tofu_functions.</code><code class="descname">find_time_range</code><span class="sig-paren">(</span><em>shot_number</em>, <em>tight_range=False</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.find_time_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the time range for which the 99.5% of the neutron events have
ocurred using TIN/RNT PPF. Assumes a starting time of 40 s unless 
tight_range is set to True.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int,</span></dt>
<dd><p class="first last">Jet puse number.</p>
</dd>
<dt><strong>tight_range</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool,</span></dt>
<dd><p class="first last">If set to True, the starting point is set to the time at which
0.05% of the neutron events have ocurred.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>energy_array</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of deposited energies in MeVee.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">find_time_range</span><span class="p">(</span><span class="mi">98044</span><span class="p">)</span>
<span class="go">array([40., 56.1780014])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_time_range</span><span class="p">(</span><span class="mi">98044</span><span class="p">,</span> <span class="n">tight_range</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">array([47.26800156, 56.1780014])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_bias_level">
<code class="descclassname">tofu_functions.</code><code class="descname">get_bias_level</code><span class="sig-paren">(</span><em>board</em>, <em>shot_number</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_bias_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the bias level for the given shot, board and channel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">Board number (between 1-10).</p>
</dd>
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>blvl</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Bias level in codes</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_bias_level</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">27000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_bias_level</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">1600</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_board_name">
<code class="descclassname">tofu_functions.</code><code class="descname">get_board_name</code><span class="sig-paren">(</span><em>detector_name</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_board_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the board and channel for a corresponding detector name. The order 
of the S2’s on the ADQ412’s are back to front.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>detector_name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string,</span></dt>
<dd><p class="first last">String containing the detector name (‘S1_01’,…,’S1_05’ or 
‘S2_01’, …, ‘S2_32’)</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string,</span></dt>
<dd><p class="first last">String containing the board number corresponding to the input 
detector name.</p>
</dd>
<dt><strong>channel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string,</span></dt>
<dd><p class="first last">String containing the channel corresponding to the input detector
name.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_board_name</span><span class="p">(</span><span class="s1">&#39;S1_01&#39;</span><span class="p">)</span>
<span class="go">(&#39;01&#39;, &#39;A&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_boards">
<code class="descclassname">tofu_functions.</code><code class="descname">get_boards</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_boards" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of board names.</p>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_channels">
<code class="descclassname">tofu_functions.</code><code class="descname">get_channels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of channel names.</p>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_detector_name">
<code class="descclassname">tofu_functions.</code><code class="descname">get_detector_name</code><span class="sig-paren">(</span><em>board</em>, <em>channel</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_detector_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the detector name corresponding to the given board and channel.
The order of the S2’s on the ADQ412’s are back to front</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or int,</span></dt>
<dd><p class="first last">String or integer corresponding to the board number (1-10)</p>
</dd>
<dt><strong>channel: string,</strong></dt>
<dd><p class="first last">String containing the channel number (‘A’, ‘B’, ‘C’, or ‘D’)</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>detector_name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string,</span></dt>
<dd><p class="first last">String containing the detector name corresponding to the
input board and channel.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_detector_name</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="go">&#39;S1_01&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_dictionaries">
<code class="descclassname">tofu_functions.</code><code class="descname">get_dictionaries</code><span class="sig-paren">(</span><em>S=0</em>, <em>fill=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_dictionaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dictionaries with S1/S2 detector names as keys.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>S</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">String indicating which type of dictionary to return. Available options:</p>
</dd>
<dt><strong>fill</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, optional,</span></dt>
<dd><p class="first last">Sets the values of the dictionary to whatever is passed in “fill”.</p>
</dd>
<dt><strong>Notes</strong></dt>
<dd></dd>
<dt><strong>—–</strong></dt>
<dd></dd>
<dt><strong>The input parameter S can be set to the following modes.</strong></dt>
<dd></dd>
<dt><strong>S = 0: Returns two dictionaries, one for S1 and one for S2.</strong></dt>
<dd></dd>
<dt><strong>S = ‘S1’: Returns a dictionary for S1.</strong></dt>
<dd></dd>
<dt><strong>S = ‘S2’: Returns a dictionary for S2.</strong></dt>
<dd></dd>
<dt><strong>S = ‘merged’: Returns single dictionary with S1/S2 detector names as keys.</strong></dt>
<dd></dd>
<dt><strong>S = ‘nested’: Returns a nested dictionary where each S1 contains a</strong></dt>
<dd></dd>
<dt><strong>dictionary with S2 detector names as keys.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>S1_dictionary</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict,</span></dt>
<dd><p class="first last">Dictionary with S1 detector names as keys.</p>
</dd>
<dt><strong>S2_dictionary</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict,</span></dt>
<dd><p class="first last">Dictionary with S2 detector names as keys.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">get_dictionaries</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="go">dict_keys([&#39;S1_01&#39;, &#39;S1_02&#39;, &#39;S1_03&#39;, &#39;S1_04&#39;, &#39;S1_05&#39;])</span>
<span class="go">dict_values([[1, 2, 3], [1, 2, 3], [1, 2, 3], [1, 2, 3], [1, 2, 3]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">dict_keys([&#39;S2_01&#39;, &#39;S2_02&#39;, &#39;S2_03&#39;, &#39;S2_04&#39;, &#39;S2_05&#39;, </span>
<span class="go">           &#39;S2_06&#39;, &#39;S2_07&#39;, &#39;S2_08&#39;, &#39;S2_09&#39;, &#39;S2_10&#39;, </span>
<span class="go">           &#39;S2_11&#39;, &#39;S2_12&#39;, &#39;S2_13&#39;, &#39;S2_14&#39;, &#39;S2_15&#39;, </span>
<span class="go">           &#39;S2_16&#39;, &#39;S2_17&#39;, &#39;S2_18&#39;, &#39;S2_19&#39;, &#39;S2_20&#39;, </span>
<span class="go">           &#39;S2_21&#39;, &#39;S2_22&#39;, &#39;S2_23&#39;, &#39;S2_24&#39;, &#39;S2_25&#39;, </span>
<span class="go">           &#39;S2_26&#39;, &#39;S2_27&#39;, &#39;S2_28&#39;, &#39;S2_29&#39;, &#39;S2_30&#39;, </span>
<span class="go">           &#39;S2_31&#39;, &#39;S2_32&#39;])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_energy_calibration">
<code class="descclassname">tofu_functions.</code><code class="descname">get_energy_calibration</code><span class="sig-paren">(</span><em>areas</em>, <em>detector_name</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_energy_calibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the deposited energy (MeVee) in the given detector using the energy
calibration given in the energy calibration folder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>areas</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of pulse areas.</p>
</dd>
<dt><strong>detector_name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string,</span></dt>
<dd><p class="first last">Detector name corresponding to the pulse areas being parsed.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>energy_array</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of deposited energies in MeVee.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">energies</span> <span class="o">=</span> <span class="n">get_energy_calibration</span><span class="p">(</span><span class="n">areas</span><span class="p">,</span> <span class="s1">&#39;S1_01&#39;</span><span class="p">)</span>
<span class="go">array([0.00134, 0.23145, ..., 0.02134])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_kincut_function">
<code class="descclassname">tofu_functions.</code><code class="descname">get_kincut_function</code><span class="sig-paren">(</span><em>tof</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_kincut_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an array of times of flight [ns] and returns the corresponding 
maximal/minimal light yield for each flight time (MeVee). The calculation
is done by considering the TOFOR geometry to find the maximal/minimal
scattering angles in the S1 detectors providing an upper and lower limit
in the proton recoil energy in the S1. For the S2 there is only an upper
upper limit, as there is no requirement in the scattering direction in the 
S2s.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>tof</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of times-of-flight (ns)</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ly_S1_min</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">Array of light yields (MeVee) corresponding to the lower 
kinematic cut in S1.</p>
</dd>
<dt><strong>ly_S1_max :</strong></dt>
<dd><p class="first last">Array of light yields (MeVee) corresponding to the upper 
kinematic cut in S1.</p>
</dd>
<dt><strong>ly_S2_max :</strong></dt>
<dd><p class="first last">Array of light yields (MeVee) corresponding to the upper 
kinematic cut in S2.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_tof</span> <span class="o">=</span> <span class="p">[</span><span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">]</span> <span class="c1"># (ns)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_kincut_function</span><span class="p">(</span><span class="n">t_tof</span><span class="p">)</span>
<span class="go">(array([0.41889004, 0.37579523, 0.33857325]),</span>
<span class="go"> array([1.80448041, 1.62189197, 1.4616936 ]),</span>
<span class="go"> array([4.91064379, 4.46936204, 4.07293829]))   </span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_offset">
<code class="descclassname">tofu_functions.</code><code class="descname">get_offset</code><span class="sig-paren">(</span><em>board</em>, <em>shot_number</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the time from board initialization to JET PRE for given board and 
shot number in nanoseconds. Required to align the time stamp trains for 
ADQ412 boards.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">Board number (between 6-10) for requested time offset.</p>
</dd>
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>offset</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Nanoseconds between board initialization and JET PRE.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_offset</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">144185503141</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_offset</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">94800</span><span class="p">)</span>
<span class="go">92176638652</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_pre_trigger">
<code class="descclassname">tofu_functions.</code><code class="descname">get_pre_trigger</code><span class="sig-paren">(</span><em>board</em>, <em>shot_number</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_pre_trigger" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of pre-trigger samples used for the given shot and 
board.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">Board number (between 1-10).</p>
</dd>
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>prt_samples</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Number of pre-trigger samples.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_pre_trigger</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_pre_trigger</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">97200</span><span class="p">)</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_pulse_area">
<code class="descclassname">tofu_functions.</code><code class="descname">get_pulse_area</code><span class="sig-paren">(</span><em>pulses</em>, <em>u_factor</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_pulse_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the shifts (written in shift_file) required to line up all S1-S2 
combinations and shift the gamma peak 3.7 ns. Method is outlined in
Eriksson, Benjamin, et al. 
“New method for time alignment and time calibration of the TOFOR 
time-of-flight neutron spectrometer at JET.” 
Review of Scientific Instruments 92.3 (2021): 033538.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>shift_file</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string,</span></dt>
<dd><p class="first last">The path to the shift file.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>shifts</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict,</span></dt>
<dd><p class="first last">Dictionary with keys 
dict_keys([‘S1_01’, ‘S1_02’, ‘S1_03’, ‘S1_04’, ‘S1_05’])
Each contains 32 shifts (ns) corresponding to the S1 vs. S2 shifts.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shifts</span> <span class="o">=</span> <span class="n">get_shifts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifts</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">dict_keys([&#39;S1_01&#39;, &#39;S1_02&#39;, &#39;S1_03&#39;, &#39;S1_04&#39;, &#39;S1_05&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifts</span><span class="p">[</span><span class="s1">&#39;S1_01&#39;</span><span class="p">]</span>
<span class="go">array([ -18.95286,  -19.35286,..., -118.55286, -117.75286])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_pulses">
<code class="descclassname">tofu_functions.</code><code class="descname">get_pulses</code><span class="sig-paren">(</span><em>shot_number</em>, <em>board='N/A'</em>, <em>channel='N/A'</em>, <em>detector_name='N/A'</em>, <em>pulse_start=-1</em>, <em>pulse_end=-1</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_pulses" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns pulse data for a given board, channel and shot number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string, optional</span></dt>
<dd><p class="first last">Board number (between 1-10) for requested data. Must be given if
detector_name is not.</p>
</dd>
<dt><strong>channel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Channel name for requested data (A, B, C or D). Must be given if 
detector_name is not.</p>
</dd>
<dt><strong>detector_name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Detector name for requested data. Must be given if board and
channel are not. E.g. “S1_01”, “S1_02”, “S2_01”, “S2_02” etc.</p>
</dd>
<dt><strong>pulse_start</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Index before which pulses are not returned.</p>
</dd>
<dt><strong>pulse_end</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Index after which pulses are not returned.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pulses</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">2D array of pulse waveforms where each row corresponds to one pulse. 
Typically 64 samples in each row for ADQ14 (board 1-5) and 56
samples for ADQ412 (board 6-10).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_pulses</span><span class="p">(</span><span class="mi">94206</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="go">array([[29996, 29978, 30005, ..., 29911, 29938, 29929],</span>
<span class="go">       ...,</span>
<span class="go">       [29978, 29969, 29955, ..., 29884, 29920, 29920]], dtype=int16)   </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_pulses</span><span class="p">(</span><span class="mi">94206</span><span class="p">,</span> <span class="n">detector_name</span> <span class="o">=</span> <span class="s1">&#39;S1_04&#39;</span><span class="p">)</span>
<span class="go">array([[29996, 29978, 30005, ..., 29911, 29938, 29929],</span>
<span class="go">       ...,</span>
<span class="go">       [29978, 29969, 29955, ..., 29884, 29920, 29920]], dtype=int16)   </span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_record_length">
<code class="descclassname">tofu_functions.</code><code class="descname">get_record_length</code><span class="sig-paren">(</span><em>board</em>, <em>shot_number</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_record_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the record length in number of samples for a given board and shot
number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">Board number (between 1-10) for requested trigger level.</p>
</dd>
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>record_length</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Record length in number of samples.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_record_length</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_record_length</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">56</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_shifts">
<code class="descclassname">tofu_functions.</code><code class="descname">get_shifts</code><span class="sig-paren">(</span><em>shift_file</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_shifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the shifts (written in shift_file) required to line up all S1-S2 
combinations and shift the gamma peak 3.7 ns. Method is outlined in
Eriksson, Benjamin, et al. 
“New method for time alignment and time calibration of the TOFOR 
time-of-flight neutron spectrometer at JET.” 
Review of Scientific Instruments 92.3 (2021): 033538.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>shift_file</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string,</span></dt>
<dd><p class="first last">The path to the shift file.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>shifts</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict,</span></dt>
<dd><p class="first last">Dictionary with keys 
dict_keys([‘S1_01’, ‘S1_02’, ‘S1_03’, ‘S1_04’, ‘S1_05’])
Each contains 32 shifts (ns) corresponding to the S1 vs. S2 shifts.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shifts</span> <span class="o">=</span> <span class="n">get_shifts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifts</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">dict_keys([&#39;S1_01&#39;, &#39;S1_02&#39;, &#39;S1_03&#39;, &#39;S1_04&#39;, &#39;S1_05&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifts</span><span class="p">[</span><span class="s1">&#39;S1_01&#39;</span><span class="p">]</span>
<span class="go">array([ -18.95286,  -19.35286,..., -118.55286, -117.75286])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_temperatures">
<code class="descclassname">tofu_functions.</code><code class="descname">get_temperatures</code><span class="sig-paren">(</span><em>board</em>, <em>shot_number</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_temperatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns temperatures (deg C) at different locations on the ADQ412 and ADQ14 boards before and after acquisition.
For ADQ412 five temperatures are returned, two of which are always 256, these temperature locations on the boards
are not available for our cards. For ADQ14 seven temperatures are returned.
For information on where the temperatures are measured see the function GetTemperature() in the ADQAPI manual.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">Board number (between 1-10) for requested temperatures.</p>
</dd>
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>T0, T1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Array of temperatures on the boards before and after acquisition.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_temperatures</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">94207</span><span class="p">)</span>
<span class="go">(array([ 36.125, 256.   , 256.   ,  68.625,  41.5  ], dtype=float32),</span>
<span class="go"> array([ 36.25 , 256.   , 256.   ,  69.5  ,  41.875], dtype=float32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_time_limit">
<code class="descclassname">tofu_functions.</code><code class="descname">get_time_limit</code><span class="sig-paren">(</span><em>board</em>, <em>shot_number</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_time_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the acquisition time limit in seconds for a given board and shot
number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">Board number (between 1-10) for requested trigger level.</p>
</dd>
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time_limit</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Time limit in seconds.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_time_limit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_time_limit</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">120</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_times">
<code class="descclassname">tofu_functions.</code><code class="descname">get_times</code><span class="sig-paren">(</span><em>shot_number</em>, <em>board='N/A'</em>, <em>channel='N/A'</em>, <em>detector_name='N/A'</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns trigger time stamps for pulses on given board, channel and shot 
number in nanoseconds since board initialization.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string, optional</span></dt>
<dd><p class="first last">Board number (between 1-10) for requested data. Must be given if
detector_name is not.</p>
</dd>
<dt><strong>channel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Channel name for requested data (A, B, C or D). Must be given if 
detector_name is not.</p>
</dd>
<dt><strong>detector_name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Detector name for requested data. Must be given if board and
channel are not. E.g. “S1_01”, “S1_02”, “S2_01”, “S2_02” etc.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>time_stamps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of time stamps.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_times</span><span class="p">(</span><span class="mi">97100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="go">array([3.68841388e+06, 9.55251888e+06, 1.62414959e+07, ...,</span>
<span class="go">       1.22809128e+11, 1.22824604e+11, 1.22827203e+11])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_times</span><span class="p">(</span><span class="mi">97100</span><span class="p">,</span> <span class="n">detector_name</span> <span class="o">=</span> <span class="s1">&#39;S2_04&#39;</span><span class="p">)</span>
<span class="go">array([3.68841388e+06, 9.55251888e+06, 1.62414959e+07, ...,</span>
<span class="go">       1.22809128e+11, 1.22824604e+11, 1.22827203e+11])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.get_trigger_level">
<code class="descclassname">tofu_functions.</code><code class="descname">get_trigger_level</code><span class="sig-paren">(</span><em>board</em>, <em>channel</em>, <em>shot_number</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.get_trigger_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the trigger level in codes used for the given shot, board and 
channel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>board</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">Board number (between 1-10) for requested trigger level.</p>
</dd>
<dt><strong>channel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Channel name for requested data (A, B, C or D).</p>
</dd>
<dt><strong>shot_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or string</span></dt>
<dd><p class="first last">JET pulse number.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>trigger_level</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Trigger level in codes.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_trigger_level</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">97100</span><span class="p">)</span>
<span class="go">1500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_trigger_level</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">97200</span><span class="p">)</span>
<span class="go">26000</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.hist_1D_s">
<code class="descclassname">tofu_functions.</code><code class="descname">hist_1D_s</code><span class="sig-paren">(</span><em>x_data</em>, <em>title=''</em>, <em>log=True</em>, <em>bins=0</em>, <em>ax=-1</em>, <em>normed=0</em>, <em>density=False</em>, <em>x_label='t$_{tof}$ [ns]'</em>, <em>y_label='Counts'</em>, <em>hist_type='standard'</em>, <em>alpha=1</em>, <em>linewidth=1</em>, <em>color='k'</em>, <em>weights=None</em>, <em>linestyle='-'</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.hist_1D_s" title="Permalink to this definition">¶</a></dt>
<dd><p>Example of how to use legend:
fig = plt.figure(‘Time differences’)
ax = fig.add_subplot(111)
bins = np.linspace(0, 1.15 * np.max(dt_ADQ14), 1000)
hist_1D_s(dt_ADQ412, label = ‘ADQ412’, log = True, bins = bins, x_label = ‘Time difference [ms]’, ax = ax)
hist_1D_s(dt_ADQ14,  label = ‘ADQ14’,  log = True, bins = bins, x_label = ‘Time difference [ms]’, ax = ax)</p>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.inverted_light_yield">
<code class="descclassname">tofu_functions.</code><code class="descname">inverted_light_yield</code><span class="sig-paren">(</span><em>light_yield</em>, <em>function='gatu'</em>, <em>check=True</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.inverted_light_yield" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an array of light yields (MeVee) and converts to proton recoil energy
(MeV) using the look-up table of the inverted light yield function 
specified in “function”.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>light_yield</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of light yields given in MeVee.</p>
</dd>
<dt><strong>function</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Set to “gatu” to use the light yield function from M. Gatu Johnson,
set to “stevenato” to use light yield function from Stevanato, L., 
et al. “Light output of EJ228 scintillation neutron detectors.” 
Applied Radiation and Isotopes 69.2 (2011): 369-372.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>proton_recoil</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">Array of proton recoil energies (MeV).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">E_ly</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="c1"># (MeVee)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverted_light_yield</span><span class="p">(</span><span class="n">E_ly</span><span class="p">)</span>
<span class="go">array([3.84391241 6.12264731 8.2078698])    </span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.kinematic_cuts">
<code class="descclassname">tofu_functions.</code><code class="descname">kinematic_cuts</code><span class="sig-paren">(</span><em>tof</em>, <em>energy_S1</em>, <em>energy_S2</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.kinematic_cuts" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs kinematic cuts on the times of flight vs. energy for S1’s and 
S2’s.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>tof</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of times-of-flight (ns)</p>
</dd>
<dt><strong>energy_S1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of S1 energies (MeVee)</p>
</dd>
<dt><strong>energy_S2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of S2 energies (MeVee)</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tof_cut</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of times of flight (ns) with kinematic cuts applied,
len(tof_cut)&lt;=len(tof).</p>
</dd>
<dt><strong>energy_S1_cut</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of energies (MeVee) for S1 with kinematic cuts 
applied, len(energy_S1_cut)&lt;=len(energy_S1).</p>
</dd>
<dt><strong>energy_S2_cut</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of energies (MeVee) for S2 with kinematic cuts 
applied, len(energy_S2_cut)&lt;=len(energy_S2).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tof</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">]</span> <span class="c1"># (ns)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energy_S1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span> <span class="c1"># (MeVee)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energy_S2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span> <span class="c1"># (MeVee)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kinematic_cuts</span><span class="p">(</span><span class="n">tof</span><span class="p">,</span> <span class="n">energy_S1</span><span class="p">,</span> <span class="n">energy_S2</span><span class="p">)</span>
<span class="go">array([64, 65]), </span>
<span class="go">array([0.05, 0.1 ]), </span>
<span class="go">array([0.1, 0.2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.light_yield_function">
<code class="descclassname">tofu_functions.</code><code class="descname">light_yield_function</code><span class="sig-paren">(</span><em>proton_energy</em>, <em>function='gatu'</em>, <em>s=0.73</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.light_yield_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an array of proton recoil energies (MeV) and converts to light yield
(MeVee) using the light yield function specified in “function”.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>proton_energy</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of proton recoil energies given in MeV.</p>
</dd>
<dt><strong>function</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Set to “gatu” to use the light yield function from M. Gatu Johnson,
set to “stevenato” to use light yield function from Stevanato, L., 
et al. “Light output of EJ228 scintillation neutron detectors.” 
Applied Radiation and Isotopes 69.2 (2011): 369-372.</p>
</dd>
<dt><strong>s</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float,</span></dt>
<dd><p class="first last">Arbitrary scaling factor, default set to s=0.73, to ensure that the light
yield function matches the measured spectrum.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>light_yield</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">Array of light yields (MeVee).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">E_p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.84391241</span><span class="p">,</span> <span class="mf">6.12264731</span><span class="p">,</span> <span class="mf">8.2078698</span><span class="p">]</span> <span class="c1"># (MeV)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">light_yield_function</span><span class="p">(</span><span class="n">E_p</span><span class="p">)</span>
<span class="go">array([1.00004149, 2.00002003, 3.00005272])    </span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.linear_regression">
<code class="descclassname">tofu_functions.</code><code class="descname">linear_regression</code><span class="sig-paren">(</span><em>x_data</em>, <em>y_data</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.linear_regression" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the slope (A) and intersection (B) for a simple linear regression 
on x and y data on the for y = Ax+B.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">2D array of x-data</p>
</dd>
<dt><strong>y_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">2D array of y-data</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>slope</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of slopes (A) of the linear regression on the form y = Ax+B
for each row of x_data and y_data</p>
</dd>
<dt><strong>intercept</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">1D array of intercepts (B) of the linear regression on the form 
y = Ax+B for each row of x_data and y_data</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linear_regression</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
<span class="go">(array([-0.12838402,  0.03837328,  0.23679145, -0.11515894, -0.08433706,</span>
<span class="go">        -0.01809531, -0.02958148, -0.01858007,  0.13560102,  0.30361892]),</span>
<span class="go"> array([53.50304412, 49.65230379, 37.04726166, 53.7653137 , 52.42589113,</span>
<span class="go">        49.156337  , 48.59527858, 48.24523488, 38.27435695, 37.49710363]))    </span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.plot_2D">
<code class="descclassname">tofu_functions.</code><code class="descname">plot_2D</code><span class="sig-paren">(</span><em>times_of_flight</em>, <em>energy_S1</em>, <em>energy_S2</em>, <em>bins_tof=array([-199.8</em>, <em>-199.4</em>, <em>-199.</em>, <em>-198.6</em>, <em>-198.2</em>, <em>-197.8</em>, <em>-197.4</em>, <em>-197.</em>, <em>-196.6</em>, <em>-196.2</em>, <em>-195.8</em>, <em>-195.4</em>, <em>-195.</em>, <em>-194.6</em>, <em>-194.2</em>, <em>-193.8</em>, <em>-193.4</em>, <em>-193.</em>, <em>-192.6</em>, <em>-192.2</em>, <em>-191.8</em>, <em>-191.4</em>, <em>-191.</em>, <em>-190.6</em>, <em>-190.2</em>, <em>-189.8</em>, <em>-189.4</em>, <em>-189.</em>, <em>-188.6</em>, <em>-188.2</em>, <em>-187.8</em>, <em>-187.4</em>, <em>-187.</em>, <em>-186.6</em>, <em>-186.2</em>, <em>-185.8</em>, <em>-185.4</em>, <em>-185.</em>, <em>-184.6</em>, <em>-184.2</em>, <em>-183.8</em>, <em>-183.4</em>, <em>-183.</em>, <em>-182.6</em>, <em>-182.2</em>, <em>-181.8</em>, <em>-181.4</em>, <em>-181.</em>, <em>-180.6</em>, <em>-180.2</em>, <em>-179.8</em>, <em>-179.4</em>, <em>-179.</em>, <em>-178.6</em>, <em>-178.2</em>, <em>-177.8</em>, <em>-177.4</em>, <em>-177.</em>, <em>-176.6</em>, <em>-176.2</em>, <em>-175.8</em>, <em>-175.4</em>, <em>-175.</em>, <em>-174.6</em>, <em>-174.2</em>, <em>-173.8</em>, <em>-173.4</em>, <em>-173.</em>, <em>-172.6</em>, <em>-172.2</em>, <em>-171.8</em>, <em>-171.4</em>, <em>-171.</em>, <em>-170.6</em>, <em>-170.2</em>, <em>-169.8</em>, <em>-169.4</em>, <em>-169.</em>, <em>-168.6</em>, <em>-168.2</em>, <em>-167.8</em>, <em>-167.4</em>, <em>-167.</em>, <em>-166.6</em>, <em>-166.2</em>, <em>-165.8</em>, <em>-165.4</em>, <em>-165.</em>, <em>-164.6</em>, <em>-164.2</em>, <em>-163.8</em>, <em>-163.4</em>, <em>-163.</em>, <em>-162.6</em>, <em>-162.2</em>, <em>-161.8</em>, <em>-161.4</em>, <em>-161.</em>, <em>-160.6</em>, <em>-160.2</em>, <em>-159.8</em>, <em>-159.4</em>, <em>-159.</em>, <em>-158.6</em>, <em>-158.2</em>, <em>-157.8</em>, <em>-157.4</em>, <em>-157.</em>, <em>-156.6</em>, <em>-156.2</em>, <em>-155.8</em>, <em>-155.4</em>, <em>-155.</em>, <em>-154.6</em>, <em>-154.2</em>, <em>-153.8</em>, <em>-153.4</em>, <em>-153.</em>, <em>-152.6</em>, <em>-152.2</em>, <em>-151.8</em>, <em>-151.4</em>, <em>-151.</em>, <em>-150.6</em>, <em>-150.2</em>, <em>-149.8</em>, <em>-149.4</em>, <em>-149.</em>, <em>-148.6</em>, <em>-148.2</em>, <em>-147.8</em>, <em>-147.4</em>, <em>-147.</em>, <em>-146.6</em>, <em>-146.2</em>, <em>-145.8</em>, <em>-145.4</em>, <em>-145.</em>, <em>-144.6</em>, <em>-144.2</em>, <em>-143.8</em>, <em>-143.4</em>, <em>-143.</em>, <em>-142.6</em>, <em>-142.2</em>, <em>-141.8</em>, <em>-141.4</em>, <em>-141.</em>, <em>-140.6</em>, <em>-140.2</em>, <em>-139.8</em>, <em>-139.4</em>, <em>-139.</em>, <em>-138.6</em>, <em>-138.2</em>, <em>-137.8</em>, <em>-137.4</em>, <em>-137.</em>, <em>-136.6</em>, <em>-136.2</em>, <em>-135.8</em>, <em>-135.4</em>, <em>-135.</em>, <em>-134.6</em>, <em>-134.2</em>, <em>-133.8</em>, <em>-133.4</em>, <em>-133.</em>, <em>-132.6</em>, <em>-132.2</em>, <em>-131.8</em>, <em>-131.4</em>, <em>-131.</em>, <em>-130.6</em>, <em>-130.2</em>, <em>-129.8</em>, <em>-129.4</em>, <em>-129.</em>, <em>-128.6</em>, <em>-128.2</em>, <em>-127.8</em>, <em>-127.4</em>, <em>-127.</em>, <em>-126.6</em>, <em>-126.2</em>, <em>-125.8</em>, <em>-125.4</em>, <em>-125.</em>, <em>-124.6</em>, <em>-124.2</em>, <em>-123.8</em>, <em>-123.4</em>, <em>-123.</em>, <em>-122.6</em>, <em>-122.2</em>, <em>-121.8</em>, <em>-121.4</em>, <em>-121.</em>, <em>-120.6</em>, <em>-120.2</em>, <em>-119.8</em>, <em>-119.4</em>, <em>-119.</em>, <em>-118.6</em>, <em>-118.2</em>, <em>-117.8</em>, <em>-117.4</em>, <em>-117.</em>, <em>-116.6</em>, <em>-116.2</em>, <em>-115.8</em>, <em>-115.4</em>, <em>-115.</em>, <em>-114.6</em>, <em>-114.2</em>, <em>-113.8</em>, <em>-113.4</em>, <em>-113.</em>, <em>-112.6</em>, <em>-112.2</em>, <em>-111.8</em>, <em>-111.4</em>, <em>-111.</em>, <em>-110.6</em>, <em>-110.2</em>, <em>-109.8</em>, <em>-109.4</em>, <em>-109.</em>, <em>-108.6</em>, <em>-108.2</em>, <em>-107.8</em>, <em>-107.4</em>, <em>-107.</em>, <em>-106.6</em>, <em>-106.2</em>, <em>-105.8</em>, <em>-105.4</em>, <em>-105.</em>, <em>-104.6</em>, <em>-104.2</em>, <em>-103.8</em>, <em>-103.4</em>, <em>-103.</em>, <em>-102.6</em>, <em>-102.2</em>, <em>-101.8</em>, <em>-101.4</em>, <em>-101.</em>, <em>-100.6</em>, <em>-100.2</em>, <em>-99.8</em>, <em>-99.4</em>, <em>-99.</em>, <em>-98.6</em>, <em>-98.2</em>, <em>-97.8</em>, <em>-97.4</em>, <em>-97.</em>, <em>-96.6</em>, <em>-96.2</em>, <em>-95.8</em>, <em>-95.4</em>, <em>-95.</em>, <em>-94.6</em>, <em>-94.2</em>, <em>-93.8</em>, <em>-93.4</em>, <em>-93.</em>, <em>-92.6</em>, <em>-92.2</em>, <em>-91.8</em>, <em>-91.4</em>, <em>-91.</em>, <em>-90.6</em>, <em>-90.2</em>, <em>-89.8</em>, <em>-89.4</em>, <em>-89.</em>, <em>-88.6</em>, <em>-88.2</em>, <em>-87.8</em>, <em>-87.4</em>, <em>-87.</em>, <em>-86.6</em>, <em>-86.2</em>, <em>-85.8</em>, <em>-85.4</em>, <em>-85.</em>, <em>-84.6</em>, <em>-84.2</em>, <em>-83.8</em>, <em>-83.4</em>, <em>-83.</em>, <em>-82.6</em>, <em>-82.2</em>, <em>-81.8</em>, <em>-81.4</em>, <em>-81.</em>, <em>-80.6</em>, <em>-80.2</em>, <em>-79.8</em>, <em>-79.4</em>, <em>-79.</em>, <em>-78.6</em>, <em>-78.2</em>, <em>-77.8</em>, <em>-77.4</em>, <em>-77.</em>, <em>-76.6</em>, <em>-76.2</em>, <em>-75.8</em>, <em>-75.4</em>, <em>-75.</em>, <em>-74.6</em>, <em>-74.2</em>, <em>-73.8</em>, <em>-73.4</em>, <em>-73.</em>, <em>-72.6</em>, <em>-72.2</em>, <em>-71.8</em>, <em>-71.4</em>, <em>-71.</em>, <em>-70.6</em>, <em>-70.2</em>, <em>-69.8</em>, <em>-69.4</em>, <em>-69.</em>, <em>-68.6</em>, <em>-68.2</em>, <em>-67.8</em>, <em>-67.4</em>, <em>-67.</em>, <em>-66.6</em>, <em>-66.2</em>, <em>-65.8</em>, <em>-65.4</em>, <em>-65.</em>, <em>-64.6</em>, <em>-64.2</em>, <em>-63.8</em>, <em>-63.4</em>, <em>-63.</em>, <em>-62.6</em>, <em>-62.2</em>, <em>-61.8</em>, <em>-61.4</em>, <em>-61.</em>, <em>-60.6</em>, <em>-60.2</em>, <em>-59.8</em>, <em>-59.4</em>, <em>-59.</em>, <em>-58.6</em>, <em>-58.2</em>, <em>-57.8</em>, <em>-57.4</em>, <em>-57.</em>, <em>-56.6</em>, <em>-56.2</em>, <em>-55.8</em>, <em>-55.4</em>, <em>-55.</em>, <em>-54.6</em>, <em>-54.2</em>, <em>-53.8</em>, <em>-53.4</em>, <em>-53.</em>, <em>-52.6</em>, <em>-52.2</em>, <em>-51.8</em>, <em>-51.4</em>, <em>-51.</em>, <em>-50.6</em>, <em>-50.2</em>, <em>-49.8</em>, <em>-49.4</em>, <em>-49.</em>, <em>-48.6</em>, <em>-48.2</em>, <em>-47.8</em>, <em>-47.4</em>, <em>-47.</em>, <em>-46.6</em>, <em>-46.2</em>, <em>-45.8</em>, <em>-45.4</em>, <em>-45.</em>, <em>-44.6</em>, <em>-44.2</em>, <em>-43.8</em>, <em>-43.4</em>, <em>-43.</em>, <em>-42.6</em>, <em>-42.2</em>, <em>-41.8</em>, <em>-41.4</em>, <em>-41.</em>, <em>-40.6</em>, <em>-40.2</em>, <em>-39.8</em>, <em>-39.4</em>, <em>-39.</em>, <em>-38.6</em>, <em>-38.2</em>, <em>-37.8</em>, <em>-37.4</em>, <em>-37.</em>, <em>-36.6</em>, <em>-36.2</em>, <em>-35.8</em>, <em>-35.4</em>, <em>-35.</em>, <em>-34.6</em>, <em>-34.2</em>, <em>-33.8</em>, <em>-33.4</em>, <em>-33.</em>, <em>-32.6</em>, <em>-32.2</em>, <em>-31.8</em>, <em>-31.4</em>, <em>-31.</em>, <em>-30.6</em>, <em>-30.2</em>, <em>-29.8</em>, <em>-29.4</em>, <em>-29.</em>, <em>-28.6</em>, <em>-28.2</em>, <em>-27.8</em>, <em>-27.4</em>, <em>-27.</em>, <em>-26.6</em>, <em>-26.2</em>, <em>-25.8</em>, <em>-25.4</em>, <em>-25.</em>, <em>-24.6</em>, <em>-24.2</em>, <em>-23.8</em>, <em>-23.4</em>, <em>-23.</em>, <em>-22.6</em>, <em>-22.2</em>, <em>-21.8</em>, <em>-21.4</em>, <em>-21.</em>, <em>-20.6</em>, <em>-20.2</em>, <em>-19.8</em>, <em>-19.4</em>, <em>-19.</em>, <em>-18.6</em>, <em>-18.2</em>, <em>-17.8</em>, <em>-17.4</em>, <em>-17.</em>, <em>-16.6</em>, <em>-16.2</em>, <em>-15.8</em>, <em>-15.4</em>, <em>-15.</em>, <em>-14.6</em>, <em>-14.2</em>, <em>-13.8</em>, <em>-13.4</em>, <em>-13.</em>, <em>-12.6</em>, <em>-12.2</em>, <em>-11.8</em>, <em>-11.4</em>, <em>-11.</em>, <em>-10.6</em>, <em>-10.2</em>, <em>-9.8</em>, <em>-9.4</em>, <em>-9.</em>, <em>-8.6</em>, <em>-8.2</em>, <em>-7.8</em>, <em>-7.4</em>, <em>-7.</em>, <em>-6.6</em>, <em>-6.2</em>, <em>-5.8</em>, <em>-5.4</em>, <em>-5.</em>, <em>-4.6</em>, <em>-4.2</em>, <em>-3.8</em>, <em>-3.4</em>, <em>-3.</em>, <em>-2.6</em>, <em>-2.2</em>, <em>-1.8</em>, <em>-1.4</em>, <em>-1.</em>, <em>-0.6</em>, <em>-0.2</em>, <em>0.2</em>, <em>0.6</em>, <em>1.</em>, <em>1.4</em>, <em>1.8</em>, <em>2.2</em>, <em>2.6</em>, <em>3.</em>, <em>3.4</em>, <em>3.8</em>, <em>4.2</em>, <em>4.6</em>, <em>5.</em>, <em>5.4</em>, <em>5.8</em>, <em>6.2</em>, <em>6.6</em>, <em>7.</em>, <em>7.4</em>, <em>7.8</em>, <em>8.2</em>, <em>8.6</em>, <em>9.</em>, <em>9.4</em>, <em>9.8</em>, <em>10.2</em>, <em>10.6</em>, <em>11.</em>, <em>11.4</em>, <em>11.8</em>, <em>12.2</em>, <em>12.6</em>, <em>13.</em>, <em>13.4</em>, <em>13.8</em>, <em>14.2</em>, <em>14.6</em>, <em>15.</em>, <em>15.4</em>, <em>15.8</em>, <em>16.2</em>, <em>16.6</em>, <em>17.</em>, <em>17.4</em>, <em>17.8</em>, <em>18.2</em>, <em>18.6</em>, <em>19.</em>, <em>19.4</em>, <em>19.8</em>, <em>20.2</em>, <em>20.6</em>, <em>21.</em>, <em>21.4</em>, <em>21.8</em>, <em>22.2</em>, <em>22.6</em>, <em>23.</em>, <em>23.4</em>, <em>23.8</em>, <em>24.2</em>, <em>24.6</em>, <em>25.</em>, <em>25.4</em>, <em>25.8</em>, <em>26.2</em>, <em>26.6</em>, <em>27.</em>, <em>27.4</em>, <em>27.8</em>, <em>28.2</em>, <em>28.6</em>, <em>29.</em>, <em>29.4</em>, <em>29.8</em>, <em>30.2</em>, <em>30.6</em>, <em>31.</em>, <em>31.4</em>, <em>31.8</em>, <em>32.2</em>, <em>32.6</em>, <em>33.</em>, <em>33.4</em>, <em>33.8</em>, <em>34.2</em>, <em>34.6</em>, <em>35.</em>, <em>35.4</em>, <em>35.8</em>, <em>36.2</em>, <em>36.6</em>, <em>37.</em>, <em>37.4</em>, <em>37.8</em>, <em>38.2</em>, <em>38.6</em>, <em>39.</em>, <em>39.4</em>, <em>39.8</em>, <em>40.2</em>, <em>40.6</em>, <em>41.</em>, <em>41.4</em>, <em>41.8</em>, <em>42.2</em>, <em>42.6</em>, <em>43.</em>, <em>43.4</em>, <em>43.8</em>, <em>44.2</em>, <em>44.6</em>, <em>45.</em>, <em>45.4</em>, <em>45.8</em>, <em>46.2</em>, <em>46.6</em>, <em>47.</em>, <em>47.4</em>, <em>47.8</em>, <em>48.2</em>, <em>48.6</em>, <em>49.</em>, <em>49.4</em>, <em>49.8</em>, <em>50.2</em>, <em>50.6</em>, <em>51.</em>, <em>51.4</em>, <em>51.8</em>, <em>52.2</em>, <em>52.6</em>, <em>53.</em>, <em>53.4</em>, <em>53.8</em>, <em>54.2</em>, <em>54.6</em>, <em>55.</em>, <em>55.4</em>, <em>55.8</em>, <em>56.2</em>, <em>56.6</em>, <em>57.</em>, <em>57.4</em>, <em>57.8</em>, <em>58.2</em>, <em>58.6</em>, <em>59.</em>, <em>59.4</em>, <em>59.8</em>, <em>60.2</em>, <em>60.6</em>, <em>61.</em>, <em>61.4</em>, <em>61.8</em>, <em>62.2</em>, <em>62.6</em>, <em>63.</em>, <em>63.4</em>, <em>63.8</em>, <em>64.2</em>, <em>64.6</em>, <em>65.</em>, <em>65.4</em>, <em>65.8</em>, <em>66.2</em>, <em>66.6</em>, <em>67.</em>, <em>67.4</em>, <em>67.8</em>, <em>68.2</em>, <em>68.6</em>, <em>69.</em>, <em>69.4</em>, <em>69.8</em>, <em>70.2</em>, <em>70.6</em>, <em>71.</em>, <em>71.4</em>, <em>71.8</em>, <em>72.2</em>, <em>72.6</em>, <em>73.</em>, <em>73.4</em>, <em>73.8</em>, <em>74.2</em>, <em>74.6</em>, <em>75.</em>, <em>75.4</em>, <em>75.8</em>, <em>76.2</em>, <em>76.6</em>, <em>77.</em>, <em>77.4</em>, <em>77.8</em>, <em>78.2</em>, <em>78.6</em>, <em>79.</em>, <em>79.4</em>, <em>79.8</em>, <em>80.2</em>, <em>80.6</em>, <em>81.</em>, <em>81.4</em>, <em>81.8</em>, <em>82.2</em>, <em>82.6</em>, <em>83.</em>, <em>83.4</em>, <em>83.8</em>, <em>84.2</em>, <em>84.6</em>, <em>85.</em>, <em>85.4</em>, <em>85.8</em>, <em>86.2</em>, <em>86.6</em>, <em>87.</em>, <em>87.4</em>, <em>87.8</em>, <em>88.2</em>, <em>88.6</em>, <em>89.</em>, <em>89.4</em>, <em>89.8</em>, <em>90.2</em>, <em>90.6</em>, <em>91.</em>, <em>91.4</em>, <em>91.8</em>, <em>92.2</em>, <em>92.6</em>, <em>93.</em>, <em>93.4</em>, <em>93.8</em>, <em>94.2</em>, <em>94.6</em>, <em>95.</em>, <em>95.4</em>, <em>95.8</em>, <em>96.2</em>, <em>96.6</em>, <em>97.</em>, <em>97.4</em>, <em>97.8</em>, <em>98.2</em>, <em>98.6</em>, <em>99.</em>, <em>99.4</em>, <em>99.8</em>, <em>100.2</em>, <em>100.6</em>, <em>101.</em>, <em>101.4</em>, <em>101.8</em>, <em>102.2</em>, <em>102.6</em>, <em>103.</em>, <em>103.4</em>, <em>103.8</em>, <em>104.2</em>, <em>104.6</em>, <em>105.</em>, <em>105.4</em>, <em>105.8</em>, <em>106.2</em>, <em>106.6</em>, <em>107.</em>, <em>107.4</em>, <em>107.8</em>, <em>108.2</em>, <em>108.6</em>, <em>109.</em>, <em>109.4</em>, <em>109.8</em>, <em>110.2</em>, <em>110.6</em>, <em>111.</em>, <em>111.4</em>, <em>111.8</em>, <em>112.2</em>, <em>112.6</em>, <em>113.</em>, <em>113.4</em>, <em>113.8</em>, <em>114.2</em>, <em>114.6</em>, <em>115.</em>, <em>115.4</em>, <em>115.8</em>, <em>116.2</em>, <em>116.6</em>, <em>117.</em>, <em>117.4</em>, <em>117.8</em>, <em>118.2</em>, <em>118.6</em>, <em>119.</em>, <em>119.4</em>, <em>119.8</em>, <em>120.2</em>, <em>120.6</em>, <em>121.</em>, <em>121.4</em>, <em>121.8</em>, <em>122.2</em>, <em>122.6</em>, <em>123.</em>, <em>123.4</em>, <em>123.8</em>, <em>124.2</em>, <em>124.6</em>, <em>125.</em>, <em>125.4</em>, <em>125.8</em>, <em>126.2</em>, <em>126.6</em>, <em>127.</em>, <em>127.4</em>, <em>127.8</em>, <em>128.2</em>, <em>128.6</em>, <em>129.</em>, <em>129.4</em>, <em>129.8</em>, <em>130.2</em>, <em>130.6</em>, <em>131.</em>, <em>131.4</em>, <em>131.8</em>, <em>132.2</em>, <em>132.6</em>, <em>133.</em>, <em>133.4</em>, <em>133.8</em>, <em>134.2</em>, <em>134.6</em>, <em>135.</em>, <em>135.4</em>, <em>135.8</em>, <em>136.2</em>, <em>136.6</em>, <em>137.</em>, <em>137.4</em>, <em>137.8</em>, <em>138.2</em>, <em>138.6</em>, <em>139.</em>, <em>139.4</em>, <em>139.8</em>, <em>140.2</em>, <em>140.6</em>, <em>141.</em>, <em>141.4</em>, <em>141.8</em>, <em>142.2</em>, <em>142.6</em>, <em>143.</em>, <em>143.4</em>, <em>143.8</em>, <em>144.2</em>, <em>144.6</em>, <em>145.</em>, <em>145.4</em>, <em>145.8</em>, <em>146.2</em>, <em>146.6</em>, <em>147.</em>, <em>147.4</em>, <em>147.8</em>, <em>148.2</em>, <em>148.6</em>, <em>149.</em>, <em>149.4</em>, <em>149.8</em>, <em>150.2</em>, <em>150.6</em>, <em>151.</em>, <em>151.4</em>, <em>151.8</em>, <em>152.2</em>, <em>152.6</em>, <em>153.</em>, <em>153.4</em>, <em>153.8</em>, <em>154.2</em>, <em>154.6</em>, <em>155.</em>, <em>155.4</em>, <em>155.8</em>, <em>156.2</em>, <em>156.6</em>, <em>157.</em>, <em>157.4</em>, <em>157.8</em>, <em>158.2</em>, <em>158.6</em>, <em>159.</em>, <em>159.4</em>, <em>159.8</em>, <em>160.2</em>, <em>160.6</em>, <em>161.</em>, <em>161.4</em>, <em>161.8</em>, <em>162.2</em>, <em>162.6</em>, <em>163.</em>, <em>163.4</em>, <em>163.8</em>, <em>164.2</em>, <em>164.6</em>, <em>165.</em>, <em>165.4</em>, <em>165.8</em>, <em>166.2</em>, <em>166.6</em>, <em>167.</em>, <em>167.4</em>, <em>167.8</em>, <em>168.2</em>, <em>168.6</em>, <em>169.</em>, <em>169.4</em>, <em>169.8</em>, <em>170.2</em>, <em>170.6</em>, <em>171.</em>, <em>171.4</em>, <em>171.8</em>, <em>172.2</em>, <em>172.6</em>, <em>173.</em>, <em>173.4</em>, <em>173.8</em>, <em>174.2</em>, <em>174.6</em>, <em>175.</em>, <em>175.4</em>, <em>175.8</em>, <em>176.2</em>, <em>176.6</em>, <em>177.</em>, <em>177.4</em>, <em>177.8</em>, <em>178.2</em>, <em>178.6</em>, <em>179.</em>, <em>179.4</em>, <em>179.8</em>, <em>180.2</em>, <em>180.6</em>, <em>181.</em>, <em>181.4</em>, <em>181.8</em>, <em>182.2</em>, <em>182.6</em>, <em>183.</em>, <em>183.4</em>, <em>183.8</em>, <em>184.2</em>, <em>184.6</em>, <em>185.</em>, <em>185.4</em>, <em>185.8</em>, <em>186.2</em>, <em>186.6</em>, <em>187.</em>, <em>187.4</em>, <em>187.8</em>, <em>188.2</em>, <em>188.6</em>, <em>189.</em>, <em>189.4</em>, <em>189.8</em>, <em>190.2</em>, <em>190.6</em>, <em>191.</em>, <em>191.4</em>, <em>191.8</em>, <em>192.2</em>, <em>192.6</em>, <em>193.</em>, <em>193.4</em>, <em>193.8</em>, <em>194.2</em>, <em>194.6</em>, <em>195.</em>, <em>195.4</em>, <em>195.8</em>, <em>196.2</em>, <em>196.6</em>, <em>197.</em>, <em>197.4</em>, <em>197.8</em>, <em>198.2</em>, <em>198.6</em>, <em>199.</em>, <em>199.4</em>, <em>199.8])</em>, <em>S1_info=None</em>, <em>S2_info=None</em>, <em>tof_lim=array([-150</em>, <em>200])</em>, <em>title=''</em>, <em>tof_bg_component=0</em>, <em>log=True</em>, <em>interactive_plot=False</em>, <em>projection=0</em>, <em>disable_cuts=False</em>, <em>times_of_flight_cut=0</em>, <em>energy_S1_cut=0</em>, <em>energy_S2_cut=0</em>, <em>disable_bgs=False</em>, <em>weights=False</em>, <em>hist2D_S1=None</em>, <em>hist2D_S2=None</em>, <em>sum_shots=False</em>, <em>proton_recoil=False</em>, <em>pulse_height_spectrum=False</em>, <em>integrated_charge_spectrum=False</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.plot_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a mess, I’m sorry (it does work though).
Plots 2D histogram of TOF vs energy with projections onto time and energy axis.
times_of_flight: 1D array of times of flight.
energy_S1: 1D array of energies for S1
energy_S2: 1D array of energies for S2
bins_tof: bins for 1D time of flight spectrum
bins_energy: bins for 1D energy spectrum
bins_2D: bins for 2D spectrum of energy vs. time of flight
energy_lim: set energy plotting limits
title: title
log: set log scale
interactive_plot: set to true to set cuts in each spectrum
projection: used in replot_projections() function, allows for red lines to be plotted along the limits of the cuts</p>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.remove_led">
<code class="descclassname">tofu_functions.</code><code class="descname">remove_led</code><span class="sig-paren">(</span><em>time_stamps</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.remove_led" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes chunk of LED data at the end of time stamp train. Assumes that the
frequency of the LED source is 5 kHz.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>time_stamps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of time stamps.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>t</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of time stamps without LED chunk.</p>
</dd>
<dt><strong>led_start</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Index in time_stamps at which LED started.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.replot_projections">
<code class="descclassname">tofu_functions.</code><code class="descname">replot_projections</code><span class="sig-paren">(</span><em>limits</em>, <em>panel_choice</em>, <em>times_of_flight</em>, <em>energy_S1</em>, <em>energy_S2</em>, <em>bins_tof</em>, <em>S1_info=None</em>, <em>S2_info=None</em>, <em>log=True</em>, <em>disable_cuts=False</em>, <em>disable_bgs=False</em>, <em>energy_S1_cut=0</em>, <em>energy_S2_cut=0</em>, <em>times_of_flight_cut=0</em>, <em>proton_recoil=False</em>, <em>pulse_height_spectrum=False</em>, <em>integrated_charge_spectrum=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.replot_projections" title="Permalink to this definition">¶</a></dt>
<dd><p>Replot the spectra with a cut on one of the energy projections
limits: limits of cuts for projections. 1x2 array for 1D spectrum, 2x2 array for 2D spectrum
panel_choice: panel to be cut (BR - bottom right, ML - middle left, TR - top right etc.)
times_of_flight: 1D array of times of flight
energy_S1: 1D array of energies for S1
energy_S2: 1D array of energies for S2</p>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.sTOF4">
<code class="descclassname">tofu_functions.</code><code class="descname">sTOF4</code><span class="sig-paren">(</span><em>S1_times</em>, <em>S2_times</em>, <em>t_back</em>, <em>t_forward</em>, <em>return_indices=False</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.sTOF4" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the time differences between S1_times and S2_times given a search
window. We loop over the time stamps in S2, for each S2 time stamp we 
search for an event in S1 within a given time window for events. If such an
event is found the time difference is calculated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>S1_times</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of time stamps for one S1, typically given in ns.</p>
</dd>
<dt><strong>S2_times</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of time stamps for one S2, typically given in ns.</p>
</dd>
<dt><strong>t_back</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or float</span></dt>
<dd><p class="first last">Time to look backwards in time from any given S2 time stamp. 
Constitutes together with t_forward, the time window in which we 
search for S1 events.</p>
</dd>
<dt><strong>t_forward</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or float</span></dt>
<dd><p class="first last">Time to look forwards in time from any given S2 time stamp. 
Constitutes together with t_back, the time window in which we 
search for S1 events.</p>
</dd>
<dt><strong>return_indices</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to true, returns S1 and S2 indices for each found
coincidence.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>delta_t</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of time differences between S1 and S2 time stamps (i.e. 
times-of-flight).</p>
</dd>
<dt><strong>indices</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">2D array of indices for each coincidence. First column
corresponds to S1, second column to S2.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">33</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sTOF</span><span class="p">(</span><span class="n">s1_times</span><span class="p">,</span> <span class="n">s2_times</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">array([-1.,  3.,  2.,  1., -1.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.sinc_interpolation">
<code class="descclassname">tofu_functions.</code><code class="descname">sinc_interpolation</code><span class="sig-paren">(</span><em>pulse_data</em>, <em>x_values</em>, <em>ux_values</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.sinc_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns since-interpolation of given pulse data set.
See Matlab example: 
<a class="reference external" href="http://phaseportrait.blogspot.com/2008/06/sinc-interpolation-in-matlab.html">http://phaseportrait.blogspot.com/2008/06/sinc-interpolation-in-matlab.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pulse_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">2D array of pulse waveforms where each row corresponds to one 
pulse. Typically 64 samples in each row for ADQ14 (board 1-5) 
and 56 samples for ADQ412 (board 6-10). NOTE: pulse_data must be
baseline reduced (see baseline_reduction() function).</p>
</dd>
<dt><strong>x_values</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of values corresponding to x_axis of pulse_data. 
Length between each point in x_values must be constant.</p>
</dd>
<dt><strong>ux_values: ndarray</strong></dt>
<dd><p class="first last">1D array similar to x_values but upsampled. Length between each
point in ux_values must be constant.</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>u_pulse_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">2D array of sinc-interpolated pulse waveforms where each row
corresponds to one pulse.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Let n be the number of records and m the number of samples per record</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ux_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span> <span class="c1"># Upsampled 10 times</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u_pulse_data</span> <span class="o">=</span> <span class="n">since_interpolation</span><span class="p">(</span><span class="n">pulse_data</span><span class="p">,</span> <span class="n">x_values</span><span class="p">,</span> <span class="n">ux_values</span><span class="p">)</span>    
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tofu_functions.time_pickoff_CFD">
<code class="descclassname">tofu_functions.</code><code class="descname">time_pickoff_CFD</code><span class="sig-paren">(</span><em>pulse_data</em>, <em>fraction=0.3</em>, <em>timer=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tofu_functions.time_pickoff_CFD" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the times of arrival for a 2D array of pulses using a constant
fraction and a linear interpolation method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pulse_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray,</span></dt>
<dd><p class="first last">2D array of pulse waveforms where each row corresponds to one 
pulse. Typically 64 samples in each row for ADQ14 (board 1-5) 
and 56 samples for ADQ412 (board 6-10). NOTE: pulse_data must be
baseline reduced (see baseline_reduction function).</p>
</dd>
<dt><strong>fraction</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Fraction at which to perform the linear interpolation</p>
</dd>
<dt><strong>timer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If set to True, prints the time to execute the function.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>new_time</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">1D array of times-of-arrival for each pulse.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time_pickoff_CFD</span><span class="p">(</span><span class="n">pulse_data</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="go">[12.5149318,  14.97846766, ... 12.53181554, 12.39070941, 12.94160379]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">docs</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Benjamin Eriksson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>